# /commit - スマートコミット

ステージされた変更を分析し、リポジトリの既存コミットスタイルに合わせたメッセージを生成してコミットする。

## 引数

$ARGUMENTS: コミットメッセージのヒント（省略可。省略時は変更内容から自動生成）

## 処理フロー

以下のステップを順に実行すること。

### 1. ステージ状態の確認

- `git diff --cached --stat` でステージされた変更を確認
- ステージされた変更がない場合:
  - `git status --short` で未ステージの変更を確認
  - 未ステージの変更がある場合: 変更一覧を表示し、何をステージするかユーザーに確認
  - 変更自体がない場合: 「コミットする変更がありません」と報告して終了

### 2. 機密ファイルチェック

ステージされたファイルに以下が含まれていないか確認:
- `.env*`（`.envrc`を除く）
- `credentials.json`
- `secrets.*`
- `*.pem`, `*.key`
- `id_rsa*`, `id_ed25519*`

該当ファイルがある場合は**警告**を表示し、除外するかユーザーに確認する。

### 3. コミットスタイルの検出

`git log --oneline -20` で直近のコミット履歴を取得し、以下を検出:
- 言語: 日本語 / 英語
- プレフィックス: Conventional Commits（feat:, fix:等）/ なし / 独自パターン
- 文体: 体言止め / 動詞で始まる / その他

### 4. 変更内容の分析

- `git diff --cached` で差分の詳細を取得
- 変更の性質を判定: 新機能追加 / バグ修正 / リファクタリング / テスト / ドキュメント / その他
- 変更の要点を把握

### 5. コミットメッセージの生成

- $ARGUMENTSが指定されている場合はそれをヒントにする
- ステップ3で検出したスタイルに合わせてメッセージを生成
- 変更の「何を」ではなく「なぜ」を重視
- 簡潔に1-2文で記述

### 6. ユーザー確認

生成したコミットメッセージを表示し、ユーザーに確認:
- そのまま使用
- 修正して使用
- キャンセル

### 7. コミット実行

承認されたメッセージでコミットを実行する。

### 8. 要約出力

以下の情報を報告:
- コミットハッシュ（短縮形）
- コミットメッセージ
- 変更されたファイル数と行数（insertions/deletions）
