# /pr - Pull Request作成

構造化されたPull Requestを作成する。ブランチの全コミットを分析し、タイトルと本文を生成して`gh pr create`で作成する。

## 引数

$ARGUMENTS: ベースブランチ（省略時はmain/masterを自動検出）

## 処理フロー

以下のステップを順に実行すること。

### 1. 前提確認

- `gh --version` で`gh`コマンドが利用可能か確認。なければ中断し、インストール案内
- `gh auth status` で認証状態を確認。未認証なら`gh auth login`を案内して中断

### 2. ベースブランチの決定

- $ARGUMENTSが指定されていればそれをベースブランチとする
- 未指定の場合:
  - `git remote show origin` でHEADブランチを確認
  - または `main` / `master` のうち存在するものを使用

### 3. 現在のブランチ確認

- `git branch --show-current` で現在のブランチを取得
- ベースブランチと同じ場合は警告して中断

### 4. リモートへのpush

- `git status -sb` でリモートのトラッキング状態を確認
- リモートにpushされていない場合、または最新でない場合: `git push -u origin <ブランチ>` を実行

### 5. 変更の分析

- `git log <ベース>..HEAD --oneline` で全コミットを一覧
- `git diff <ベース>...HEAD --stat` で変更ファイルの概要を確認
- `git diff <ベース>...HEAD` で差分の詳細を確認
- 全コミット（分岐点からHEADまで）を漏れなく分析する

### 6. PRタイトルと本文の生成

- タイトル: 70文字以内、変更の要約
- 本文は以下の構造:

```
## Summary
<変更の概要を1-3個の箇条書きで>

## Changes
<主要な変更点の説明>

## Test plan
<テスト方法のチェックリスト>
```

- コミット履歴の言語（日本語/英語）に合わせる

### 7. ユーザー確認

生成したタイトルと本文を表示し、ユーザーに確認:
- そのまま作成
- 修正して作成
- キャンセル

### 8. PR作成

`gh pr create --title "<タイトル>" --body "<本文>"` で作成する。

### 9. 要約出力

以下の情報を報告:
- PRのURL
- タイトル
- ベースブランチ ← 現在のブランチ
- コミット数と変更ファイル数
